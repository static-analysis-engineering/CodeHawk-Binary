{"name": "functioninvariants", "title": "json result file for the location invariants within a function", "type": "object", "required": ["meta"], "properties": {"meta": {"description": "CodeHawk json result metadata", "type": "object", "required": ["status", "date", "time", "version"], "properties": {"status": {"type": "string", "enum": ["ok", "fail"], "description": "indication if data gathering was successful"}, "date": {"type": "string", "format": "date", "description": "date (YYYY-MM-DD) of result"}, "time": {"type": "string", "description": "time (HH:MM:SS) of result"}, "schema": {"type": "string", "enum": ["functioninvariants"], "description": "name of json result schema"}, "version": {"type": "string", "description": "CodeHawk-Binary version number"}, "reason": {"type": "string", "description": "Reason for failure"}}}, "content": {"name": "functioninvariants", "description": "All invariant facts associated with all locations in a function", "type": "object", "properties": {"invariants": {"type": "array", "items": {"$ref": "#/$defs/locationinvariant"}}}}}, "$defs": {"locationinvariant": {"name": "locationinvariant", "title": "location invariant", "description": "All invariant facts associated with a location", "type": "object", "properties": {"location": {"type": "string", "description": "instruction hexaddress at which the assertions hold before execution of the instruction at that address"}, "invariants": {"type": "array", "items": {"$ref": "#/$defs/invariantfact"}, "description": "list of invariants that hold at this location"}}}, "invariantfact": {"name": "invariantfact", "title": "invariant fact", "description": "Assertion about the state at a particular program location (address)", "type": "object", "oneOf": [{"type": "object", "description": "assertion that location is unreachable, with domain that reached that conclusion", "required": ["kind", "domain", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["unr"]}, "domain": {"type": "string", "description": "domain with bottom result"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "variable has or does not have the same value as the value at function entry", "required": ["kind", "relation", "var", "initval", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["ival"]}, "relation": {"type": "string", "enum": ["equals", "not-equals"]}, "var": {"$ref": "#/$defs/xvariable"}, "initval": {"$ref": "#/$defs/xvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "relationship between value of testvariable at test location and jump location (for evaluation of branch predicate)", "required": ["kind", "testaddr", "jumpaddr", "testvar", "testval", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["tst"]}, "testaddr": {"type": "string", "description": "hex address of instruction setting the condition codes"}, "jumpaddr": {"type": "string", "description": "hex address of conditional branch instruction"}, "testvar": {"$ref": "#/$defs/xvariable"}, "testval": {"$ref": "#/$defs/xvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "variable equality with non-relational value", "required": ["kind", "nrv", "var", "nrv", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["nrv"]}, "var": {"$ref": "#/$defs/xvariable"}, "nrv": {"$ref": "#/$defs/nonrelationalvalue"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "location is unreachable; name of domain indicates the abstract domain that reaches this conclusion", "required": ["kind", "domain", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["unr"]}, "domain": {"type": "string", "description": "domain that signals unreachability"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "linear equality over program variables", "required": ["kind", "lineq", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["lineq"]}, "lineq": {"$ref": "#/$defs/linearequality"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "xvariable": {"name": "xvariable", "title": "variable", "description": "variable with or without denotation", "type": "object", "oneOf": [{"type": "object", "description": "temporary variable without denotation", "required": ["kind", "temp", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["temp"]}, "temp": {"type": "string"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "memory variable", "required": ["kind", "base", "offset", "size", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["memvar"]}, "base": {"$ref": "#/$defs/memorybase"}, "offset": {"$ref": "#/$defs/memoryoffset"}, "size": {"type": "integer", "description": "size of variable in bytes"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "register variable", "required": ["kind", "register", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["regvar"]}, "register": {"type": "string", "description": "name of register"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "variable with a fixed (possibly symbolic) value", "required": ["kind", "fxdval", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["fxd"]}, "fxdval": {"$ref": "#/$defs/auxvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "memorybase": {"name": "memorybase", "title": "memory base", "description": "(symbolic) pointer to base of memory region", "type": "object", "oneOf": [{"type": "object", "description": "known base: function stack frame or global", "required": ["stack"], "properties": {"stack": {"type": "string", "enum": ["local", "allocated", "realigned", "global"]}}}, {"type": "object", "description": "pointer contained in fixed-value variable", "required": ["ptrvar"], "properties": {"ptrvar": {"$ref": "#/$defs/xvariable"}}}, {"type": "object", "description": "global base or unknown", "required": ["other"], "properties": {"other": {"type": "string", "enum": ["global", "unknown"]}}}]}, "memoryoffset": {"name": "memoryoffset", "title": "memory offset", "description": "(possibly symbolic) offset in bytes from a memory base", "type": "object", "oneOf": [{"type": "object", "description": "no offset", "required": ["kind"], "properties": {"kind": {"type": "string", "enum": ["none"]}}}, {"type": "object", "description": "constant numerical offset", "required": ["kind", "value", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["cv"]}, "value": {"type": "integer", "description": "offset value in bytes"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "constant numerical offset with suboffset", "required": ["kind", "value", "suboffset", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["cvo"]}, "value": {"type": "integer", "description": "offset value in bytes"}, "suboffset": {"$ref": "#"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "index offset with variable and element size", "required": ["kind", "ixvar", "elsize", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["iv"]}, "ixvar": {"$ref": "#/$defs/xvariable"}, "elsize": {"type": "integer", "description": "size of element indexed"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "index offset with suboffset", "required": ["kind", "ixvar", "elsize", "suboffset", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["ivo"]}, "ixvar": {"$ref": "#/$defs/xvariable"}, "elsize": {"type": "integer", "description": "size of element indexed"}, "suboffset": {"$ref": "#"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "auxvariable": {"name": "auxvariable", "title": "auxiliary variable", "description": "variable with a fixed symbolic value", "type": "object", "oneOf": [{"type": "object", "description": "value of the register upon function entry", "required": ["kind", "register", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["irv"]}, "register": {"type": "string", "description": "name of register"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "value of memory location upon function entry", "required": ["kind", "memvar", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["imv"]}, "memvar": {"$ref": "#/$defs/xvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "value of variable frozen at test location", "required": ["kind", "testaddr", "jumpaddr", "testvar", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["ftv"]}, "testaddr": {"type": "string", "description": "hex address of test location"}, "jumpaddr": {"type": "string", "description": "hex address of conditional branch"}, "testvar": {"$ref": "#/$defs/xvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "value of return value from a function call", "required": ["kind", "callsite", "calltarget", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["frv"]}, "callsite": {"type": "string", "description": "hexaddress of function call site"}, "calltarget": {"type": "string", "description": "name of function called"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "memory address", "required": ["kind", "base", "offset", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["ma"]}, "base": {"$ref": "#/$defs/memorybase"}, "offset": {"$ref": "#/$defs/memoryoffset"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "symbolic representation of expression", "required": ["kind", "expr", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["svx"]}, "expr": {"$ref": "#/$defs/xexpression"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "xexpression": {"name": "xexpression", "title": "symbolic expression", "description": "native representation expression", "type": "object", "oneOf": [{"type": "object", "description": "constant expression", "required": ["kind", "cst", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["xcst"]}, "cst": {"$ref": "#/$defs/xconstant"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "variable", "required": ["var", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["xvar"]}, "var": {"$ref": "#/$defs/xvariable"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "compound expression", "required": ["kind", "operator", "operands", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["xop"]}, "operator": {"type": "string", "description": "operation performed"}, "operands": {"type": "array", "description": "list of operands (usually one or two)", "items": {"$ref": "#/$defs/xexpression"}}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "xconstant": {"name": "xconstant", "title": "constant value", "description": "constant value in expression", "type": "object", "oneOf": [{"type": "object", "description": "integer constant", "required": ["kind", "value"], "properties": {"kind": {"type": "string", "enum": ["icst"]}, "value": {"type": "integer"}}}, {"type": "object", "description": "integer constant string address", "required": ["kind", "value", "stringref"], "properties": {"kind": {"type": "string", "enum": ["strcst"]}, "value": {"type": "integer"}, "stringref": {"type": "string", "description": "string at numerical address"}}}]}, "nonrelationalvalue": {"name": "nonrelationalvalue", "title": "non-relational value", "description": "symbolic constant", "type": "object", "oneOf": [{"type": "object", "description": "numeric value", "required": ["kind", "value", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["civ"]}, "value": {"type": "integer", "description": "constant singleton value"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "closed range of values", "required": ["kind", "lb", "ub", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["itv"]}, "lb": {"type": "integer", "description": "lowerbound (inclusive) of range"}, "ub": {"type": "integer", "description": "upperbound (inclusive) of range"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "lower-bounded, half-open range of values", "required": ["kind", "lb", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["lb-itv"]}, "lb": {"type": "integer", "description": "lowerbound of half-open range"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "upper-bounded, half-open range of values", "required": ["kind", "ub", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["ub-itv"]}, "ub": {"type": "integer", "description": "upperbound of half-open range"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "base with numeric constant offset", "required": ["kind", "base", "value", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["b-civ"]}, "base": {"type": "string", "description": "symbolic base address"}, "value": {"type": "integer", "description": "offset (in bytes) from base address"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "base with bounded range of numeric offsets", "required": ["kind", "base", "lb", "ub", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["b-itv"]}, "base": {"type": "string", "description": "symbolic base address"}, "lb": {"type": "integer", "description": "lowerbound (inclusive) of offset range (in bytes)"}, "ub": {"type": "integer", "description": "upperbound (inclusive) of offset range (in bytes)"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "half-open range of address values", "required": ["kind", "base", "lb", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["b-lb-itv"]}, "base": {"type": "string", "description": "name of a base variable"}, "lb": {"type": "integer", "description": "lower-bound of the range"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "half-open range of values", "required": ["kind", "base", "ub", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["b-ub-itv"]}, "base": {"type": "string", "description": "name of a base variable"}, "ub": {"type": "integer", "description": "upper-bound of the range"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "base only with unbounded interval", "required": ["kind", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["b-unb"]}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}, {"type": "object", "description": "symbolic expression", "required": ["kind", "sym-expr", "txtrep"], "properties": {"kind": {"type": "string", "enum": ["sx"]}, "sym-expr": {"$ref": "#/$defs/xexpression"}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}]}, "linearequality": {"name": "linearequality", "title": "linear equality", "description": "linear equality of the form sum(a_i . x_i) = c", "type": "object", "required": ["constant", "coeffs", "factors", "txtrep"], "properties": {"constant": {"type": "integer", "description": "constant factor"}, "coeffs": {"type": "array", "items": {"type": "integer", "description": "coefficient a_i (may be 0)"}}, "factors": {"description": "factors x_i", "type": "array", "items": {"$ref": "#/$defs/xvariable"}}, "txtrep": {"type": "string", "description": "suggested textual representation"}}}}}